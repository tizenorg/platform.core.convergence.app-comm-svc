<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Debug Logs</title>


    <link rel="stylesheet" href="/resources/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="/resources/css/bootstrap-theme.min.css">

    <script src="/resources/js/jquery.min.js"></script>
    <script src="/resources/js/bootstrap.min.js"></script>

    <style>

        .level-warn{
            color : rgb(236, 197, 37);
        }

        .level-error {
            color: rgb(255, 60, 60);
        }

        .level-verbose{
            color : rgb(108, 185, 192);
        }

        .level-debug{
            color : rgb(199, 152, 152);
        }

        .level-silly{
            color : rgb(121, 121, 121);
        }

        .level-info{
            color : rgb(49, 192, 49);
        }

        #logPanel table{
            table-layout:fixed;
        }

        #log td{
            word-wrap:break-word;
        }

        #log td.level{
            width:100px;
        }

        #log td.time{
            width:100px;
        }

    </style>

</head>
<body>

<div class="container-fluid">
    <div class="page-header">
        <h1>MultiScreen Service Logs</h1>
        <button id="btnClear" type="button" class="btn btn-info">CLEAR</button>
    </div>

    <div id="logPanel" class="panel panel-primary">
        <div class="panel-heading">Logs</div>
        <div class="panel-body">
            <table class="table table-striped">
                <tbody id="log">
                </tbody>
            </table>
        </div>
    </div>

</div>

<script>

    var ws = new WebSocket('ws://'+window.location.host+'/logger');

    ws.onopen = function(){
        console.info("ws is open");
    };

    ws.onclose = function(){
        console.info("ws is closed");
    };

    ws.onerror = function(err){
        console.error(err);
    };

    ws.onmessage = function(msg){

        console.debug(msg.data);

        msg = JSON.parse(msg.data);

        var row = "";
        row += '<tr class="level-' + msg.level +'">';
        row += '<td class="level">' + msg.level.toUpperCase() + '</td>';
        row += '<td class="message">' + JSON.stringify(msg.msg, null, " ") + '</td>';
        row += '<td class="meta">' + JSON.stringify(msg.meta, null, " ") + '</td>';
        row += '</tr>';

        $('#log').append(row);
    };

    $('#btnClear').on('click', function(){
        $('#log').empty();
    });

</script>







</body>
</html>